# 8. 图模型
概率论在模式识别中占有重要地位，概率论可以由**sum rule**和**product rule**两个简单方程组合而成。我们可以使用这两个公式构建任意复杂的概率模型，但是这种方法很不直观，所以我们发明了图表示来化简这一过程。

## 8.1 贝叶斯网络
诸如

$$p(x_1)p(x_2)p(x_3)p(x_4|x_1,x_2,x_3)p(x_5|x_1,x_3)p(x_6|x_4)p(x_7|x_4,x_5) $$

的表达式可以用图

![5a11667b92b25e5a4821b1660d79d57b.png](evernotecid://60614192-C7C5-4611-9CAC-5D15AB1BE3D8/appyinxiangcom/7169492/ENResource/p13364) 


来表示

### 8.1.1 多项式拟合
整个多项式拟合的模型可以表示成

$$p(\hat{t}|\hat  x, \boldsymbol{x}, \boldsymbol{t}, \alpha, \sigma^2)  \propto \int p(\hat t, \boldsymbol t , w |  \hat x, \boldsymbol x,\alpha, \sigma^2 ) dw $$

![0719d5b43844c91b32b74b6afef2d96a.png](evernotecid://60614192-C7C5-4611-9CAC-5D15AB1BE3D8/appyinxiangcom/7169492/ENResource/p13365) 



### 8.1.2 生成模型

**ancestral sampling**： 按照分布依赖关系，一个接一个采样。可以在简化数据生成的同时，生成分布更复杂的模型。

### 8.1.3 离散变量
对离散变量，在图模型中 ，多条边代表多重依赖，对于依赖N条有K个不同值的边的节点，其参数为$K^N-1$。而对全独立变量，参数为$NK$量级，全连接无法计算，不连接受限太严重，我们一般会取中间状态。比如每个节点一一连接，或者参数共享来减少总参数个数。还有一个办法就是使用类似logistic regresssion的方式，将多条边的依赖聚和成一条边的依赖。

### 8.1.4 线性高斯模型
`不太理解`

## 8.2 条件独立
如果 $p(a|b,c) = p(a|c)$ 则我们称a给定c时与b条件独立。条件独立在模式识别中拥有重要的意义。或者写成$⫫ $。条件独立从图中图模型中可以一眼看出 。这种方法的框架叫**d-separation**d表示directed。

### 三个模型

- **tail-to-tail**: 没观测时a,b不独立，观测c后ab独立
- **head-to-tail**:没观测时a,b不独立，观测c后ab独立
- **head-to-head**: 没观测c时ab独立，观测c后ab不独立

### D-separation
i.i.d 对应**tail2tail**模式，每次观测互相独立。而如果将先验概率积分起来，新观测值显然与之前的观测值相关。
朴素贝叶斯 假设每次采样独立，每个class独立。


## 8.3 马尔科夫随机场
**马尔科夫随机场**又被成为**马尔科夫网络**或者**无向图模型**。
### 8.3.1 条件独立属性
在有向图中可以使用 d-separition 对一个图测试是否存在特定的条件独立。而条件独立取决于之间路径是否被堵塞，路径堵塞又多种情况。而在无向图中可以用简单的图分割判断。
在一个无向图中， $A ⫫ B | C$ 在AB之间所有连接路径都经过C时成立。另一个解决方案是将C中的节点移除。

### 8.3.2 分解属性
**clique**：团内所有成员两两相连。
 一个**clique**内的成员的概率可以表示为
 
 $$p(x) = \frac 1 Z \prod_C \phi_c(x_c)$$
 Z为归一化函数，C为clique，$\phi_c$ 为任意>0方程 叫做势能方程。

### 8.3.4 和有向图的关联
 有向图转成无向图，对于只有一个父节点的节点可以简单将$p(a|b)$ 转变成 $p(a,b)$。而对于有多个父节点的情况，则要求所有父节点属于同一个团，所以有$p(a|b,c,d)$ 转换成$p(a,b,c,d)$。这种将父节点两两相连的操作叫做**moraliztion**。所得的图叫做**moral graph**。有些有向图无法用无向图表达，有些无向图无法用有向图来表达。

## 8.4 图模型的推论

### 8.4.1 链的推论
类似动态规划算法。将$K^N$ 算法编程$NK^2$ 量级 。从图上看就是全连接图和链状图。这种链状图叫马尔科夫链。
### 8.4.2 树
无向图- 没有环的称为树
有向图- 每个节点只有一个父节点，只有一个根节点没有父节点。
有向图- 可以由多个父节点，有多个根节点叫**polytree（超树）**

### 8.4.3 因子图
因子图分解时将$p(x) = f_a(x_1, x_2)f_b(x_1,x_2)f_c(x_2,x_3)f_d(x_3)$每个$f_a,f_b,f_c,f_d$分解成一个方块，每个变量$x_1,x_2,x_3$还是一个圈，最后圈和方块相连

### 8.4.4 sum-product算法
 sum-product算法从一个有向或者无向树图，得到变量的边缘分布。

